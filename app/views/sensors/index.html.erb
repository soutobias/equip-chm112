<div class="banner1">
  <div class="container text-center justify-content-center align-middle">
    <h1 class="font-weight-bold">EQUIPAMENTOS</h1>
  </div>
</div>
<div class="m-5">
  <div class="filtro">
    <h1 class="font-weight-bold text-center p-3 h1">DEFINIR PARÂMETROS DE BUSCA</h1>
    <%= form_tag sensors_path, method: :get, class: 'w-100 form-horizontal row justify-content-around align-items-center vertical-align-center' do %>
      <div class="col-3 w-100 p-3">
        <% if @commit && @situation_id != ""%>
          <%= select_tag :situation, options_from_collection_for_select(@situations, "id", "status"), selected: @situation_id,
            class: "form-control"
          %>
        <% else %>
          <%= select_tag :situation, options_from_collection_for_select(@situations, "id", "status"), include_blank: "SITUAÇÃO",
            class: "form-control"
          %>
        <% end %>
      </div>
      <div class="col-3 w-100 p-3">
        <% if @commit && @place_id != "" %>
          <%= select_tag :place, options_from_collection_for_select(@places, "id", "place"), selected: @place_id,
            class: "form-control"
          %>
        <% else %>
          <%= select_tag :place, options_from_collection_for_select(@places, "id", "place"), include_blank: "LOCAL",
            class: "form-control"
          %>
        <% end %>
      </div>
      <div class="col-3 w-100 p-3">
        <% if @commit && @item_id != "" %>
          <%= select_tag :item, options_from_collection_for_select(@items, "id", "item"), include_blank: false, selected: @item_id,
            class: "form-control"
          %>
        <% else %>
          <%= select_tag :item, options_from_collection_for_select(@items, "id", "item"), include_blank: "ITEM",
            class: "form-control"
          %>
        <% end %>
      </div>
      <div class="col-3 w-100 p-3">
        <% if @commit && @item_type_id != "" %>
          <%= select_tag :item_type, options_from_collection_for_select(@item_types, "id", "item_type"), include_blank: false, selected: @item_type_id,
            class: "form-control"
          %>
        <% else %>
          <%= select_tag :item_type, options_from_collection_for_select(@item_types, "id", "item_type"), include_blank: "SUBITEM",
            class: "form-control"
          %>
        <% end %>
      </div>
      <div class="col-3 w-100 p-3">
        <div class="d-flex justify-content-around">
          <p class="m-3">AQUISIÇÃO: </p>
          <%= date_field_tag :acquisition_date, @acquisition_date, class: "form-control p-3"  %>
        </div>
      </div>
      <div class="col-3 w-100 p-3">
        <div class="d-flex vertical-align-center justify-content-around">
          <p class="m-3">CALIBRAÇÃO: </p>
          <%= date_field_tag :calibration_date, @calibration_date, class: "form-control p-3" %>
        </div>
      </div>
      <div class="col-3 w-100 p-3">
        <div class="d-flex justify-content-around">
          <p class="m-3">MANUTENÇÃO: </p>
          <%= date_field_tag :maintenance_date, @maintenance_date, class: "form-control p-3" %>
        </div>
      </div>
      <div class="col-3 w-100 p-3 d-flex">
        <%= submit_tag("Procurar", class: "btn btn-outline-success p-3 w-75 button") %>
        <%= link_to "Limpar busca", root_path, class: 'btn btn-outline-primary align-middle h-75 ml-2 button' %>
      </div>
    <% end %>
  </div>
  <div class="results">
    <h1 class='font-weight-bold text-center p-3 h1'>LISTA DE SENSORES</h1>
    <table class="rwd-table">
      <tr>
        <th><%= link_to "ID", :sort => "id"%> </th>
        <th><%= link_to "ITEM", :sort => "items.item"%> </th>
        <th><%= link_to "SUBITEM", :sort => "item_types.item_type"%> </th>
        <th><%= link_to "N° DE SÉRIE", :sort => "serial_number"%> </th>
        <th><%= link_to "PROGRAMA", :sort => "owner"%> </th>
        <th><%= link_to "N° REGISTRO", :sort => "register_number"%> </th>
        <th><%= link_to "MODELO", :sort => "model"%> </th>
        <th><%= link_to "FABRICANTE", :sort => "manufacturer"%> </th>
        <th><%= link_to "LOCAL", :sort => "places.place"%> </th>
        <th><%= link_to "SITUAÇÃO", :sort => "situations.status"%> </th>
        <th><%= link_to "DATA DE AQUISIÇÃO", :sort => "acquisition_date"%> </th>
        <th><%= link_to "DATA DE MANUTENÇÃO", :sort => "maintenance_date"%> </th>
        <th><%= link_to "DATA DE CALIBRAÇÃO", :sort => "calibration_date"%> </th>
        <th>AÇÕES</th>
      </tr>
      <% if @x == 1 %>
        <% @sensors.each do |sensor| %>
          <tr>
            <td data-th="Id"><%=sensor.id%></td>
            <td data-th="Item"><%=sensor.item.item %></td>
            <td data-th="Subitem"><%=sensor.item_type.item_type %></td>
            <td data-th="Número de Série"><%=sensor.serial_number %></td>
            <td data-th="Programa"><%=sensor.owner %></td>
            <td data-th="Número de Registro"><%=sensor.register_number %></td>
            <td data-th="Modelo"><%=sensor.model %></td>
            <td data-th="Fabricante"><%=sensor.manufacturer %></td>
            <td data-th="Local"><%=sensor.place.place %></td>
            <td data-th="Situação"><%=sensor.situation.status %></td>
            <% if sensor.acquisition_date %>
              <td data-th="Data de Aquisição"><%=sensor.acquisition_date.strftime('%d/%m/%Y') %></td>
            <% else %>
              <td data-th="Data de Aquisição"><%=sensor.acquisition_date %></td>
            <% end %>
            <% if sensor.maintenance_date %>
              <td data-th="Data de Manutenção"><%=sensor.maintenance_date.strftime('%d/%m/%Y') %></td>
            <% else %>
              <td data-th="Data de Manutenção"><%=sensor.maintenance_date %></td>
            <% end %>
            <% if sensor.calibration_date %>
              <td data-th="Data de Calibração"><%=sensor.calibration_date.strftime('%d/%m/%Y') %></td>
            <% else %>
              <td data-th="Data de Calibração"><%=sensor.calibration_date %></td>
            <% end %>
            <td>
              <%= link_to edit_sensor_path(sensor), class: "btn text-primary p-0" do %>
                <i class="far fa-edit"></i>
              <% end %>
              <%= link_to sensor_path(sensor), class: "btn text-primary p-0" do %>
                <i class="far fa-eye"></i>
              <% end %>
            </td>
          </tr>
        <% end %>
        </table>
      <% else %>
        </table>
        <h2 class='font-italic text-center p-3 h1'>FAÇA UMA BUSCA</h2>
      <% end %>
  </div>
</div>
